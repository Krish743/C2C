<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Admin â€“ Upload & Ingest</title>
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <style>
    body{background:#f6f8fb}
    .card{box-shadow:0 6px 18px rgba(0,0,0,.06);border:0;border-radius:14px}
  </style>
</head>
<body>
<div class="container py-5">
  <h2 class="mb-4 text-primary">ðŸ“¤ Upload & Ingest Documents</h2>

  <div class="card">
    <div class="card-body">
      <form id="upload-form" class="row g-3">
        <div class="col-md-4">
          <label class="form-label">Department</label>
          <select id="department" class="form-select" required>
            <option value="">Select Department</option>
            <option>Artificial Intelligence and Machine Learning</option>
            <option>Automobile Engineering</option>
            <option>Biomedical Engineering</option>
            <option>Chemical Engineering</option>
            <option>Civil Engineering</option>
            <option>Computer Engineering</option>
            <option>Electrical Engineering</option>
            <option>Electronics and Communication Engineering</option>
            <option>Environmental Engineering</option>
            <option>Information Technology</option>
            <option>Instrumentation & Control Engineering</option>
            <option>Mechanical Engineering</option>
            <option>Plastic Technology</option>
            <option>Robotics and Automation</option>
            <option>Rubber Technology</option>
            <option>Science and Humanities</option>
            <option>Textile Technology</option>
          </select>
        </div>

        <div class="col-md-3">
          <label class="form-label">Category</label>
          <select id="category" class="form-select" required>
            <option value="">Select Category</option>
            <option value="circulars">Circulars</option>
            <option value="exam_schedules">Exam Schedules</option>
            <option value="events">Events</option>
            <option value="fees">Fees</option>
            <option value="policies">Policies</option>
            <option value="registration">Registration</option>
            <option value="deadlines">Deadlines</option>
            <option value="courses">Courses</option>
            <option value="facilities">Facilities</option>
          </select>
        </div>

        <div class="col-md-5">
          <label class="form-label">Document (PDF/TXT/DOCX)</label>
          <input id="file" type="file" class="form-control" accept=".pdf,.txt,.docx" required>
        </div>

        <div class="col-12 d-flex align-items-center gap-3">
          <button class="btn btn-primary" type="submit">Upload & Ingest</button>
          <span id="upload-status" class="fw-semibold"></span>
        </div>
      </form>
    </div>
  </div>
</div>

<script>
const $ = (id)=>document.getElementById(id);

document.getElementById("upload-form").addEventListener("submit", async (e) => {
  e.preventDefault();
  const file = $("file").files[0];
  const department = $("department").value;
  const category = $("category").value;

  if (!file || !department || !category) {
    $("upload-status").textContent = "Please fill all fields.";
    $("upload-status").className = "text-danger";
    return;
  }

  $("upload-status").textContent = "Uploadingâ€¦";
  $("upload-status").className = "text-primary";

  const fd = new FormData();
  fd.append("file", file);
  fd.append("department", department);
  fd.append("category", category);

  try {
    const res = await fetch("/upload", { method: "POST", body: fd });
    const data = await res.json();
    $("upload-status").textContent = data.message || "Uploaded. Ingestion started.";
    $("upload-status").className = "text-success";
  } catch (e) {
    $("upload-status").textContent = "Upload failed.";
    $("upload-status").className = "text-danger";
    console.error(e);
  }
});
</script>
</body>
</html>
